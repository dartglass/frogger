import "dart:html" as h;class PF{static const  QF="Chrome";static const  RF="Safari";final  vE;final  minimumVersion;const PF(this.vE,[this.minimumVersion]);}class SF{const SF();}class TF{final  name;const TF(this.name);}class UF{const UF();}class VF{const VF();}class DB{var canvas;var height;var width;var FB;var QB;var JB=9;var rows=5;var xB=0;var m;var background;var CB;var t;var CC;DB(this.canvas){m=canvas.getContext('2d');height=canvas.height;width=canvas.width;QB=width~/JB;FB=height~/rows;print("canvas.height = ${height}");print("cavnas.width = ${width}");CC=new KC(this,width,height);background=new LC(this);CB=new JC(this);t=new List<RB>();t.add(new RB(this,3,0,0));t.add(new RB(this,4,2,2));t.add(new RB(this,4,4,3));t.add(new RB(this,1,0,4));t.add(new RB(this,6,0,6));t.add(new RB(this,6,2,6));t.add(new RB(this,7,2,7));}zE(){}v(){MC(m,width,height);CC.v();background.v();CB.v();t.forEach(( g)=>g.v());wE();}update( g){CB.update(g);t.forEach(( i)=>i.update(g));}rB( g){xB+= g;}wE(){m.font='16pt Calibri';m.strokeText(xB.toString(),10,25);}}class LC{var k;var backgroundImage;LC(this.k){backgroundImage=new h.Element.tag('img');backgroundImage.src="images/game-field.jpg";}v(){k.m.drawImage(backgroundImage,0,0);}}class RB{var k;var x;var y;var sB;var YF;var speed;var direction;var o;RB( g, j, i, s){this.k=g;this.sB=j;this.x=j*g.QB;this.y=i;speed=1;o=new h.Element.tag('img');switch (s){case 0:o.src="images/car1-down.png";direction=1;break;case 1:o.src="images/car1a-down.png";direction=1;break;case 2:o.src="images/car1-up.png";direction=-1;break;case 3:o.src="images/car1a-up.png";direction=-1;break;case 4:o.src="images/truck2-up.png";direction=-1;break;case 5:o.src="images/truck2-down.png";direction=1;break;case 6:o.src="images/log2.png";direction=1;break;case 7:o.src="images/log3.png";direction=-1;break;case 8:o.src="images/log4.png";direction=1;break;}YF=(g.FB*i)-o.height;}v(){var g=k.QB;var i=k.FB;k.m.drawImage(o,x,YF);}update( g){YF=YF+(speed*direction);if(direction>0){if(YF>k.height+o.height){YF=0-o.height;}}else{if(YF<(o.height*-1)){YF=k.height+o.height;}}var ZF=(YF/k.FB);if(k.CB.x==sB){if(ZF>1.0&&ZF<2.0){k.CB.AF();}}}}class JC{var k;var x;var y;var splat;var BC;var IF;var PB;var ZB;var aB;var AC;JC(this.k){x=0;y=2*k.FB;splat=false;PB=0;ZB=new h.Element.tag('img');ZB.src="images/frogger.png";aB=new h.Element.tag('img');aB.src="images/frogger-splat.png";AC=h.query("#audioJump");}v(){var g=k.QB;var i=k.FB;if(splat){k.m.drawImage(aB,BC*g,i*2);}else{k.m.drawImage(ZB,x*g,i*2);}}zB(){if(splat)return;x++ ;if(x>=k.JB){x=0;k.rB(1);}AC.play();}AF(){BC=x;IF=y;x=0;splat=true;k.rB(-1);}update( g){if(splat){PB++ ;if(PB>100){PB=0;splat=false;}}}}class KC{var k;var m;var JB=9;var rows=5;var height;var width;var fB;var bB;KC(this.k,this.width,this.height){fB=(width/JB).toInt();bB=(height/rows).toInt();print("heightSpacing = ${bB}");print("widthSpacing = ${fB}");m=k.m;}v(){for(int g=0;g<rows;g++ ){uB(0,g*bB,width,0);}for(int i=0;i<JB;i++ ){uB(i*fB,0,0,height);}} uB(i,g,j,s){m.lineWidth=1;m.lineCap="round";m.strokeStyle="white";m.beginPath();m.moveTo(i,g);m.lineTo(i+j,g+s);m.stroke();m.closePath();}}var SB;MC( i, g, j)=>i.clearRect(0,0,g,j); main(){SB=h.query("#canvas");var i=new DB(SB);var s=false;var j=false;var GB=0.0;h.document.onKeyDown.listen((BB){BB.preventDefault();if(BB.keyCode==32){i.CB.zB();}});var g=new WB(SB);g.eB=(( g){if(s==false){var LB=g.OB-GB;if(LB>1.0){s=true;}}i.update(g);});g.dB=((g){i.v();});i.zE();g.start();h.window.onDeviceMotion.listen(( MB){var HB=MB.accelerationIncludingGravity.z;if(HB>=3.0&&j==false&&s==true){j=true;GB=g.OB;i.CB.zB();}else if(HB<0.0&&j==true){j=false;}});}typedef  NC( event, repeat);abstract class jB{ get x; get y; get dx; get dy; get time; get n;}typedef  OC( gameLoop);abstract class q{var KB=0.015;var cB=0.03; get n; get OB; get xE=>KB;static  UB(g)=>g/1000.0; get time=>UB(new DateTime.now().millisecondsSinceEpoch);q(){} FF(){var aF=bF.length;for(int g=0;g<aF;g++ ){bF[g].cF(xE);}for(int g=bF.length-1;g>=0;g-- ){var i=bF.length-1;if(bF[g].dF){if(g!=i){bF[g]=bF[i];}bF.removeLast();}}} start();final  bF=new List<PC>();var eB;}class PC{}class kB{final  IB;var vB=0;var wB=0;var JF=0.0;var KF=0.0;kB(this.IB); get EB=>vB>wB;}class QC{}class TB{final  EB;final  n;final  IB;final  time;TB(this.IB,this.EB,this.n,this.time); toString()=>'Button: ${IB} DOWN: ${EB} [${n}@${time}]';}class VB{final  l;final  buttons=new Map<int,kB>();var yB;VB(this.l, i){for(int g in i){buttons[g]=new kB(g);}} tB( i){var g=buttons[i.IB];if(g==null){return;}if(yB!=null){if(yB(i,g.EB)==false){return;}}if(i.EB){if(g.EB==false){g.vB=i.n;g.JF=i.time;}}else{g.wB=i.n;g.KF=i.time;}}}class RC{final  x;final  y;final  dx;final  dy;final  XB;final  YB;final  time;final  gB;final  n;RC(this.x,this.y,this.dx,this.dy,this.XB,this.YB,this.gB,this.time,this.n);}class SC{final  l;SC(this.l){l.element.onClick.listen(eF);h.document.onPointerLockChange.listen(fF);} GF(){l.element.requestPointerLock();} eF( g){if(BF){GF();}}var BF=true; get CF=>h.document.WF==l.element; fF( g){if(l.onPointerLockChange!=null){l.onPointerLockChange(l);}}}class AB{static const lB=0x1;static const mB=0x2;static const nB=0x3;final  event;final  type;AB(this.event,this.type);}class TC{final  l;var buttons;var XF;TC(this.l){}}typedef  UC( gameLoop);class VC extends VB{static const XC=h.KeyCode.A;static const YC=h.KeyCode.B;static const aC=h.KeyCode.C;static const bC=h.KeyCode.D;static const cC=h.KeyCode.E;static const dC=h.KeyCode.F;static const fC=h.KeyCode.G;static const gC=h.KeyCode.H;static const iC=h.KeyCode.I;static const kC=h.KeyCode.J;static const mC=h.KeyCode.K;static const oC=h.KeyCode.L;static const qC=h.KeyCode.M;static const rC=h.KeyCode.N;static const sC=h.KeyCode.O;static const tC=h.KeyCode.P;static const uC=h.KeyCode.Q;static const vC=h.KeyCode.R;static const wC=h.KeyCode.S;static const xC=h.KeyCode.T;static const yC=h.KeyCode.U;static const zC=h.KeyCode.V;static const AD=h.KeyCode.W;static const BD=h.KeyCode.X;static const CD=h.KeyCode.Y;static const DD=h.KeyCode.Z;static const ED=h.KeyCode.SHIFT;static const FD=h.KeyCode.CTRL;static const GD=h.KeyCode.ALT;static const HD=h.KeyCode.SPACE;static const ID=h.KeyCode.ZERO;static const JD=h.KeyCode.ONE;static const KD=h.KeyCode.TWO;static const LD=h.KeyCode.THREE;static const MD=h.KeyCode.FOUR;static const ND=h.KeyCode.FIVE;static const OD=h.KeyCode.SIX;static const PD=h.KeyCode.SEVEN;static const QD=h.KeyCode.EIGHT;static const RD=h.KeyCode.NINE;static const SD=h.KeyCode.ENTER;static const TD=h.KeyCode.UP;static const UD=h.KeyCode.DOWN;static const hC=h.KeyCode.LEFT;static const lC=h.KeyCode.RIGHT;static const VD=h.KeyCode.ESC;static const WD=h.KeyCode.APOSTROPHE;static const XD=h.KeyCode.BACKSLASH;static const YD=h.KeyCode.BACKSPACE;static const ZD=h.KeyCode.CAPS_LOCK;static const aD=h.KeyCode.CLOSE_SQUARE_BRACKET;static const bD=h.KeyCode.COMMA;static const cD=h.KeyCode.CONTEXT_MENU;static const dD=h.KeyCode.DASH;static const eD=h.KeyCode.DELETE;static const fD=h.KeyCode.END;static const gD=h.KeyCode.EQUALS;static const hD=h.KeyCode.F1;static const iD=h.KeyCode.F2;static const jD=h.KeyCode.F3;static const kD=h.KeyCode.F4;static const lD=h.KeyCode.F5;static const mD=h.KeyCode.F6;static const nD=h.KeyCode.F7;static const oD=h.KeyCode.F8;static const pD=h.KeyCode.F9;static const qD=h.KeyCode.F10;static const rD=h.KeyCode.F11;static const sD=h.KeyCode.F12;static const tD=h.KeyCode.FF_EQUALS;static const uD=h.KeyCode.FF_SEMICOLON;static const vD=h.KeyCode.FIRST_MEDIA_KEY;static const wD=h.KeyCode.HOME;static const xD=h.KeyCode.INSERT;static const yD=h.KeyCode.LAST_MEDIA_KEY;static const zD=h.KeyCode.MAC_ENTER;static const AE=h.KeyCode.MAC_FF_META;static const BE=h.KeyCode.META;static const CE=h.KeyCode.NUM_CENTER;static const DE=h.KeyCode.NUM_DELETE;static const EE=h.KeyCode.NUM_DIVISION;static const FE=h.KeyCode.NUM_EAST;static const GE=h.KeyCode.NUM_EIGHT;static const HE=h.KeyCode.NUM_FIVE;static const IE=h.KeyCode.NUM_FOUR;static const JE=h.KeyCode.NUM_INSERT;static const KE=h.KeyCode.NUM_MINUS;static const LE=h.KeyCode.NUM_MULTIPLY;static const ME=h.KeyCode.NUM_NINE;static const NE=h.KeyCode.NUM_NORTH;static const OE=h.KeyCode.NUM_NORTH_EAST;static const PE=h.KeyCode.NUM_NORTH_WEST;static const QE=h.KeyCode.NUM_ONE;static const RE=h.KeyCode.NUM_PERIOD;static const SE=h.KeyCode.NUM_PLUS;static const TE=h.KeyCode.NUM_SEVEN;static const UE=h.KeyCode.NUM_SIX;static const VE=h.KeyCode.NUM_SOUTH;static const WE=h.KeyCode.NUM_SOUTH_EAST;static const XE=h.KeyCode.NUM_SOUTH_WEST;static const YE=h.KeyCode.NUM_THREE;static const ZE=h.KeyCode.NUM_TWO;static const aE=h.KeyCode.NUM_WEST;static const bE=h.KeyCode.NUM_ZERO;static const cE=h.KeyCode.NUMLOCK;static const dE=h.KeyCode.OPEN_SQUARE_BRACKET;static const eE=h.KeyCode.PAGE_UP;static const fE=h.KeyCode.PAGE_DOWN;static const gE=h.KeyCode.PAUSE;static const hE=h.KeyCode.PERIOD;static const iE=h.KeyCode.PRINT_SCREEN;static const jE=h.KeyCode.QUESTION_MARK;static const kE=h.KeyCode.SCROLL_LOCK;static const lE=h.KeyCode.SEMICOLON;static const mE=h.KeyCode.SINGLE_QUOTE;static const nE=h.KeyCode.SLASH;static const oE=h.KeyCode.TAB;static const pE=h.KeyCode.TILDE;static const qE=h.KeyCode.WIN_IME;static const rE=h.KeyCode.WIN_KEY;static const sE=h.KeyCode.WIN_KEY_FF_LINUX;static const tE=h.KeyCode.WIN_KEY_LEFT;static const uE=h.KeyCode.WIN_KEY_RIGHT;static final  nC=[XC,YC,aC,bC,cC,dC,fC,gC,iC,kC,mC,oC,qC,rC,sC,tC,uC,vC,wC,xC,yC,zC,AD,BD,CD,DD,ED,FD,GD,HD,ID,JD,KD,LD,MD,ND,OD,PD,QD,RD,SD,TD,UD,hC,lC,VD,WD,XD,YD,ZD,aD,bD,cD,dD,eD,fD,gD,hD,iD,jD,kD,lD,mD,nD,oD,pD,qD,rD,sD,tD,uD,vD,wD,xD,yD,zD,AE,BE,CE,DE,EE,FE,GE,HE,IE,JE,KE,LE,ME,NE,OE,PE,QE,RE,SE,TE,UE,VE,WE,XE,YE,ZE,aE,bE,cE,dE,eE,fE,gE,hE,iE,jE,kE,lE,mE,nE,oE,pE,qE,rE,sE,tE,uE];VC(g):super(g,nC);}typedef  WC( gameLoop);class oB implements jB{final  x;final  y;final  dx;final  dy;final  time;final  n;oB(this.x,this.y,this.dx,this.dy,this.time,this.n);}typedef  ZC( gameLoop);typedef  eC( gameLoop);class pB extends VB implements jB{static const hC=0;static const jC=1;static const lC=2;static final  nC=[hC,jC,lC];var iF=0; get dx=>iF;var mF=0; get dy=>mF;var qF=0; get x=>qF;var rF=0; get y=>rF;var sF=0; get XB=>sF;var vF=0; get YB=>vF;var wF=0;var zF=0;var AG=false; get gB=>AG;var CG=0.0; get time=>CG;var GG=0; get n=>GG;pB(g):super(g,nC); yE( g){qF=g.x;rF=g.y;CG=g.time;GG=g.n;iF+= g.dx;mF+= g.dy;sF=g.XB;vF=g.YB;AG=g.gB;} MG( i, g){wF+= i;zF+= g;} NG(){wF=0;zF=0;iF=0;mF=0;}}typedef  qB( gameLoop, touch);class NB{final  id;final  EF=new List<oB>();NB(this.id);}class WB extends q{final  element;var gF=0;var hF=false;var jF=false;var kF;var lF=0.0;var nF=false;var oF=0.0; get n=>gF;var cB=0.03;var tF=0.0; get width=>element.client.width; get height=>element.client.height;var xF=0.0; get OB=>xF;var yF=0.0;var HF=0.05;var BG;var EG;var HG; get DF=>HG;var IG;var JG=new h.Point(0,0);var KG;WB(this.element):super(){EG=new VC(this);HG=new pB(this);IG=new TC(this);BG=new SC(this);KG=new pC(this);} OG(){PG();RG();SG();} PG(){for(h.KeyboardEvent g in TG){var i;var BB=g.type=="keydown";var s=q.UB(g.timeStamp);var j=g.keyCode;i=new TB(j,BB,n,s);EG.tB(i);}TG.clear();} RG(){DF.NG();final DC=h.document.documentElement;final EC=element.getBoundingClientRect();var BB=(EC.left+h.window.pageXOffset-DC.clientLeft).floor();var HB=(EC.top+h.window.pageYOffset-DC.clientTop).floor();for(h.MouseEvent g in UG){var LF=g.type=='mousemove';var MF=g.type=='mousewheel';var NF=g.type=='mousedown';var FC=q.UB(g.timeStamp);if(LF){var hB=g.page.x;var GB=g.page.y;var GC=hB-BB;var HC=GB-HB;var s=0;var i=0;var j=false;if(hB<BB){s=0;}else if(hB>BB+width){s=width;}else{s=GC;j=true;}if(GB<HB){i=0;j=false;}else if(GB>HB+height){i=height;j=false;}else{i=HC;}var MB,LB;if(BG.CF){MB=g.movement.x;LB=g.movement.y;}else{MB=g.client.x-JG.x;LB=g.client.y-JG.y;JG=g.client;}JG=g.client;var iB=new RC(GC,HC,MB,LB,s,i,j,FC,n);HG.yE(iB);}else if(MF){var IC=g as h.WheelEvent;HG.MG(IC.deltaX,IC.deltaY);}else{var OF=g.button;var iB=new TB(OF,NF,n,FC);HG.tB(iB);}}UG.clear();} SG(){for(AB g in VG){switch (g.type){case AB.nB:KG.uF(g.event);break;case AB.mB:KG.FG(g.event);break;case AB.lB:KG.LG(g.event);break;default:throw new StateError('Invalid _GameLoopTouchEven type.');}}VG.clear();}var WG; XG( YG){if(kF==null){lF=time;kF=lF;OG();WG=h.window.requestAnimationFrame(XG);return;}if(jF==true){WG=null;return;}WG=h.window.requestAnimationFrame(XG);gF++ ;kF=lF;lF=time;var g=lF-kF;tF+= g;if(tF>cB){tF=cB;}OG();while (tF>=KB){FF();xF+= KB;if(eB!=null){eB(this);}tF-= KB;}if(nF==true&&onResize!=null&&oF<=lF){onResize(this);oF=lF+HF;nF=false;}if(dB!=null){yF=tF/KB;dB(this);}} ZG( YG){if(onFullscreenChange==null){return;}onFullscreenChange(this);} aG( YG){if(onFullscreenChange==null){return;}onFullscreenChange(this);}final  VG=new List<AB>(); bG( g){VG.add(new AB(g,AB.nB));g.preventDefault();} cG( g){VG.add(new AB(g,AB.lB));g.preventDefault();} dG( g){VG.add(new AB(g,AB.mB));g.preventDefault();}final  TG=new List<h.KeyboardEvent>(); eG( g){TG.add(g);} fG( g){TG.add(g);}final  UG=new List<h.MouseEvent>(); gG( g){UG.add(g);} hG( g){UG.add(g);} iG( g){UG.add(g);} jG( g){UG.add(g);g.preventDefault();} kG( YG){if(nF==false){nF=true;}} start(){if(hF==false){h.document.onFullscreenError.listen(aG);h.document.onFullscreenChange.listen(ZG);element.onTouchStart.listen(bG);element.onTouchEnd.listen(dG);element.onTouchCancel.listen(dG);element.onTouchMove.listen(cG);h.window.onKeyDown.listen(eG);h.window.onKeyUp.listen(fG);h.window.onResize.listen(kG);element.onMouseMove.listen(iG);element.onMouseDown.listen(gG);element.onMouseUp.listen(hG);element.onMouseWheel.listen(jG);hF=true;}jF=false;WG=h.window.requestAnimationFrame(XG);}var dB;var onResize;var onFullscreenChange;var onPointerLockChange;var onTouchStart;var onTouchEnd;}class pC{final  u=new Map<int,NB>();final  l;pC(this.l); pF( j, g){var i=new oB(g.page.x,g.page.y,0,0,l.OB,l.n);j.EF.add(i);} uF( j){j.changedTouches.forEach(( g){var i=new NB(g.identifier);if(u[g.identifier]!=null){return;}assert(u[g.identifier]==null);u[g.identifier]=i;pF(i,g);if(l.onTouchStart!=null){l.onTouchStart(l,i);}});DG(j.touches);} FG( j){j.changedTouches.forEach(( i){var g=u[i.identifier];if(g==null){return;}assert(g!=null);u.remove(i.identifier);pF(g,i);if(l.onTouchEnd!=null){l.onTouchEnd(l,g);}});DG(j.touches);} LG( i){i.changedTouches.forEach(( g){var j=u[g.identifier];pF(j,g);});DG(i.touches);} QG( i,j){for(int g=0;g<i.length;g++ ){if(i[g].identifier==j){return true;}}return false;}DG( g){if(g.length!=u.length){print('${g.length} ${u.length}');}u.forEach((i,j){if(!QG(g,i)){print('Did not find ${i}');}});}}